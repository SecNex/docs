# Headless Player

## What is the Headless Player?

The **Headless Player** is a part of the [EdgeSight](https://secnex.io/edgesight) solution. It is responsible for displaying the screenshots of websites, PowerBI reports, Grafana dashboards and other services on a digital signage screen. The **Headless Player** is based on [Playwright](https://playwright.dev/), a library to automate chromium, firefox and webkit browsers.
We built the **Headless Player** in Python with [Playwright](https://playwright.dev/) and [Flask](https://flask.palletsprojects.com/) and in TypeScript with [Puppeteer](https://pptr.dev/) and [Express](https://expressjs.com/).

## Architecture

The **Headless Player** consists of three parts:

- **Worker**: The worker service is responsible for taking screenshots of the websites and caching them in a local storage.
- **Server**: The server service is the core of the **Headless Player**. It is responsible for managing the devices and the screenshots.
- **Client**: The client service is responsible for displaying the screenshots on a digital signage screen.

## database

**Headless Player** uses a PostgreSQL database to store configurations. The database is used by the server and the worker and is necessary to run the **Headless Player**.

## Quick Start

To start the **Headless Player** you need only to clone the repository and a installation of [Docker](https://www.docker.com/).

```bash
git clone https://github.com/SecNex/edgesight-headless-player.git
cd edgesight-headless-player

docker compose up --build -d
```

In this example, we use [Docker Compose](https://docs.docker.com/compose/) to start the **Headless Player**. The `docker-compose.yml` file contains the configuration for the worker, server and client services.

## Configuration

### Environment Variables

The **Headless Player** uses environment variables to configure the services. You can find the environment variables in the `.env` file.

#### Server

- `DATABASE_HOST`: The hostname of the PostgreSQL database.
- `DATABASE_PORT`: The port of the PostgreSQL database.
- `DATABASE_NAME`: The name of the PostgreSQL database.
- `DATABASE_USER`: The username of the PostgreSQL database.
- `DATABASE_PASS`: The password of the PostgreSQL database.
- `SECRET_KEY`: The secret which is used to sign the JWT tokens.

#### Worker

- `API_URL`: The URL of the server API.
- `APPLICATION_ID`: The ID of the application.
- `APPLICATION_SECRET`: The secret of the application.
- `CACHE_PATH`: The path where the screenshots are cached.
- `CACHE_CLEAR`: The time in seconds when the cache is cleared.

#### Client

- `API_URL`: The URL of the server API.
- `APPLICATION_ID`: The ID of the application.
- `APPLICATION_SECRET`: The secret of the application.


